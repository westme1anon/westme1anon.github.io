import{_ as v}from"./preload-helper.BlTxHScW.js";import{c as B,B as S,d as L,D as _,e as M}from"./constants.DaUs35VT.js";import{w as A,a as b}from"./config.DloxKmO1.js";import{p as D,u as C}from"./url-utils.7_L8JPzD.js";import"./zh_TW.12WzXWON.js";const I=!!document.getElementById("banner-wrapper");async function H(){try{let e=function(t,a){document.addEventListener("click",async o=>{let s=document.getElementById(t),r=o.target;if(r instanceof Node){for(let c of a){let l=document.getElementById(c);if(l==r||l?.contains(r))return}await n.closePanel(t)}})};const{panelManager:n}=await v(async()=>{const{panelManager:t}=await import("./panel-manager.BYknToDe.js");return{panelManager:t}},[]);return e("display-setting",["display-setting","display-settings-switch"]),e("nav-menu-panel",["nav-menu-panel","nav-menu-switch"]),e("search-panel",["search-panel","search-bar","search-switch"]),e("mobile-toc-panel",["mobile-toc-panel","mobile-toc-switch"]),e("wallpaper-mode-panel",["wallpaper-mode-panel","wallpaper-mode-switch"]),n}catch(e){return console.error("Failed to initialize panel manager:",e),null}}H();function q(){document.querySelectorAll(".katex-display:not([data-scrollbar-initialized])").forEach(n=>{if(!n.parentNode)return;const t=document.createElement("div");t.className="katex-display-container",n.parentNode.insertBefore(t,n),t.appendChild(n),t.style.cssText=`
			overflow-x: auto;
			scrollbar-width: thin;
			scrollbar-color: rgba(0,0,0,0.3) transparent;
		`;const a=document.createElement("style");a.textContent=`
			.katex-display-container::-webkit-scrollbar {
				height: 6px;
			}
			.katex-display-container::-webkit-scrollbar-track {
				background: transparent;
			}
			.katex-display-container::-webkit-scrollbar-thumb {
				background: rgba(0,0,0,0.3);
				border-radius: 3px;
			}
			.katex-display-container::-webkit-scrollbar-thumb:hover {
				background: rgba(0,0,0,0.5);
			}
		`,document.head.querySelector("style[data-katex-scrollbar]")||(a.setAttribute("data-katex-scrollbar","true"),document.head.appendChild(a)),n.setAttribute("data-scrollbar-initialized","true")})}function k(){requestAnimationFrame(()=>{const e=document.getElementById("banner");e&&e.classList.remove("opacity-0","scale-105");const n=document.querySelector('.block.lg\\:hidden[alt="Mobile banner image of the blog"]');n&&!document.getElementById("banner-carousel")&&(n.classList.remove("opacity-0","scale-105"),n.classList.add("opacity-100")),document.getElementById("banner-carousel")&&P()})}function P(){const e=document.querySelectorAll(".carousel-item"),n=window.innerWidth<1024,t=Array.from(e).filter(a=>n?a.querySelector(".block.lg\\:hidden"):a.querySelector(".hidden.lg\\:block"));if(t.length>1&&!b.banner.carousel?.enable){e.forEach((s,r)=>{s.classList.add("opacity-0","scale-110"),s.classList.remove("opacity-100","scale-100")});const a=Math.floor(Math.random()*t.length),o=t[a];o.classList.add("opacity-100","scale-100"),o.classList.remove("opacity-0","scale-110");return}if(t.length>1&&b.banner.carousel?.enable){let a=function(i){const u=t[s];u.classList.remove("opacity-100","scale-100"),u.classList.add("opacity-0","scale-110"),s=i;const p=t[s];p.classList.add("opacity-100","scale-100"),p.classList.remove("opacity-0","scale-110")},o=function(){clearInterval(c),c=setInterval(()=>{if(!l){const i=(s+1)%t.length;a(i)}},r*1e3)},s=0;const r=b.banner.carousel?.interval||6;let c,l=!1,d=0,h=0,f=!1;const m=document.getElementById("banner-carousel");e.forEach(i=>{i.classList.add("opacity-0","scale-110"),i.classList.remove("opacity-100","scale-100")}),t.length>0&&(t[0].classList.add("opacity-100","scale-100"),t[0].classList.remove("opacity-0","scale-110")),m&&"ontouchstart"in window&&(m.addEventListener("touchstart",i=>{d=i.touches[0].clientX,h=i.touches[0].clientY,f=!1,l=!0,clearInterval(c)},{passive:!0}),m.addEventListener("touchmove",i=>{if(!d||!h)return;const u=Math.abs(i.touches[0].clientX-d),p=Math.abs(i.touches[0].clientY-h);u>p&&u>30&&(f=!0,i.preventDefault())},{passive:!1}),m.addEventListener("touchend",i=>{if(!d||!h||!f){l=!1,o();return}const u=i.changedTouches[0].clientX,p=d-u;if(Math.abs(p)>50)if(p>0){const g=(s+1)%t.length;a(g)}else{const g=(s-1+t.length)%t.length;a(g)}d=0,h=0,f=!1,l=!1,o()},{passive:!0})),m&&(m.addEventListener("mouseenter",()=>{l=!0,clearInterval(c)}),m.addEventListener("mouseleave",()=>{l=!1,o()})),o()}}function x(){const e=A?.sakura;!e||e.enable}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",x):x();const T=()=>{window.swup.hooks.on("link:click",()=>{if(document.documentElement.style.setProperty("--content-delay","0ms"),I){const e=document.getElementById("navbar-wrapper");if(e&&document.body.classList.contains("lg:is-home")){const n=window.innerHeight*(L/100)-88;document.documentElement.scrollTop>=n&&e.classList.add("navbar-hidden")}}}),window.swup.hooks.on("content:replace",()=>{if(q(),document.getElementById("toc-wrapper")!==null){const a=document.querySelector("table-of-contents");a&&typeof a.init=="function"&&setTimeout(()=>{a.init()},100),typeof window.mobileTOCInit=="function"&&setTimeout(()=>{window.mobileTOCInit()},100)}const t=document.getElementById("navbar");t&&t.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection()}),window.swup.hooks.on("visit:start",e=>{const n=document.querySelector("body"),t=D(e.to.url,C("/"));t?n.classList.add("lg:is-home"):n.classList.remove("lg:is-home");const a=document.querySelector(".banner-text-overlay");a&&(t?a.classList.remove("hidden"):a.classList.add("hidden"));const o=document.getElementById("navbar");o&&(o.setAttribute("data-is-home",t.toString()),o.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection());const s=document.getElementById("banner-wrapper"),r=document.querySelector(".absolute.w-full.z-30");s&&r&&(t?(setTimeout(()=>{s.classList.remove("mobile-hide-banner")},100),setTimeout(()=>{r.classList.remove("mobile-main-no-banner")},150)):(s.classList.add("mobile-hide-banner"),setTimeout(()=>{r.classList.add("mobile-main-no-banner")},100)));const c=document.getElementById("page-height-extend");c&&c.classList.remove("hidden");let l=document.getElementById("toc-wrapper");l&&l.classList.add("toc-not-ready")}),window.swup.hooks.on("page:view",()=>{const e=document.getElementById("page-height-extend");e&&e.classList.remove("hidden"),window.scrollTo({top:0,behavior:"instant"});const t=(localStorage.getItem("theme")||B)===_,a=t?"github-dark":"github-light",o=document.documentElement.getAttribute("data-theme"),s=document.documentElement.classList.contains("dark");(o!==a||s!==t)&&requestAnimationFrame(()=>{o!==a&&document.documentElement.setAttribute("data-theme",a),s!==t&&(t?document.documentElement.classList.add("dark"):document.documentElement.classList.remove("dark"))}),setTimeout(()=>{if(document.getElementById("tcomment")){const r=new CustomEvent("mizuki:page:loaded",{detail:{path:window.location.pathname,timestamp:Date.now()}});document.dispatchEvent(r),console.log("Layout: 触发 mizuki:page:loaded 事件，路径:",window.location.pathname)}},300)}),window.swup.hooks.on("visit:end",e=>{setTimeout(()=>{const n=document.getElementById("page-height-extend");n&&n.classList.add("hidden");const t=document.getElementById("toc-wrapper");t&&t.classList.remove("toc-not-ready")},200)})};window?.swup?.hooks?T():document.addEventListener("swup:enable",T);let w=document.getElementById("back-to-top-btn"),y=document.getElementById("toc-wrapper"),E=document.getElementById("navbar-wrapper");function z(e,n){let t;return function(){const a=arguments,o=this;t||(e.apply(o,a),t=!0,setTimeout(()=>t=!1,n))}}function N(){const e=document.documentElement.scrollTop,n=window.innerHeight*(L/100);requestAnimationFrame(()=>{if(w&&(e>n?w.classList.remove("hide"):w.classList.add("hide")),I&&y&&(e>n?y.classList.remove("toc-hide"):y.classList.add("toc-hide")),I&&E){const a=document.body.classList.contains("lg:is-home")&&window.innerWidth>=1024?M:L,o=window.innerHeight*(a/100)-88;e>=o?E.classList.add("navbar-hidden"):E.classList.remove("navbar-hidden")}})}window.onscroll=z(N,16);window.onresize=()=>{let e=Math.floor(window.innerHeight*(S/100));e=e-e%4,document.documentElement.style.setProperty("--banner-height-extend",`${e}px`)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",async()=>{k();try{const{panelManager:e}=await v(async()=>{const{panelManager:n}=await import("./panel-manager.BYknToDe.js");return{panelManager:n}},[]);console.log("Panel manager initialized")}catch(e){console.error("Failed to initialize panel manager:",e)}}):(k(),(async()=>{try{const{panelManager:e}=await v(async()=>{const{panelManager:n}=await import("./panel-manager.BYknToDe.js");return{panelManager:n}},[]);console.log("Panel manager initialized")}catch(e){console.error("Failed to initialize panel manager:",e)}})());
